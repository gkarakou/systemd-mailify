smtps,starttls certfile could have the key in it so do an additional check if the cert_file path is not empty but the key is( for the two sections)

Memory optimizations (we are python, hungry for server resources!)

Merge
